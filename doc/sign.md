# ファイルへの署名機能

`encrypt`パッケージの`signature`モジュールを用いてテキストファイルに署名を行う。
署名にはPGP鍵が必要となるため、事前に生成しておく。
Windows なら GPG4Win、Linux や Mac ならパッケージマネージャから GnuPG を導入することでPGP鍵の生成・管理が可能である。

##　署名の手順

1. 署名対象のファイルと、秘密鍵を用意する。PGP鍵は事前にGnuPGなどを用いて生成しておく。

2. `signature.sign_file`メソッドを実行してファイルに署名する。署名に必要となるのは、ファイルそのものと、先に生成した秘密鍵である。
   署名を実施すると、`{署名対象のファイル名}.sig`という署名ファイルが生成される。

## 検証の手順

署名を実施した秘密鍵に対応する公開鍵を用いて、署名を検証することができる。

以下、Macの場合のコマンドで手順を例示する。
1. 以下を用意して、一つのディレクトリ内に配置する。
   1. 署名した秘密鍵に対応する公開鍵 (e.g. `public_key.asc`)
   2. 署名対象のファイル (e.g. `sample.txt`)
   3. 署名ファイル (e.g. `sample.txt.sig`)
2. 2\.で用意したディレクトリに移動し、以下のコマンドを実行して公開鍵をインポートする。

```
gpg --import public_key.asc
```

4. 以下のコマンドを実行して署名を検証する。

```
gpg --verify sample.txt.sig sample.txt
```

### 検証結果の確認

もし署名が正しければ、以下のような結果が表示される。

```
gpg: 月 10/23 16:20:55 2023 JSTに施された署名
gpg:                EDDSA鍵9C0846DCD3901DFB4986618B4D5208470F31C2B8を使用
gpg: "John Doe <john.doe@example.com>"からの正しい署名 [究極]
```

署名が正しくない（署名対象のファイルが改変されている場合など）場合は、以下のような実行結果となる。

```
gpg: 月 10/23 16:20:55 2023 JSTに施された署名
gpg:                EDDSA鍵9C0846DCD3901DFB4986618B4D5208470F31C2B8を使用
gpg: "John Doe <john.doe@example.com>"からの*不正な*署名 [究極]
```
